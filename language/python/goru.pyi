from typing import Any, TypedDict, Coroutine
from asyncio import AbstractEventLoop

class HTTPResponse(TypedDict):
    status: int
    body: str

class FSEntry(TypedDict):
    name: str
    is_dir: bool
    size: int

class FSStatResult(TypedDict):
    name: str
    size: int
    is_dir: bool
    mod_time: int

# Time functions
def time_now() -> float: ...

# Sync host functions
def kv_get(key: str) -> str | None: ...
def kv_set(key: str, value: str) -> str: ...
def kv_delete(key: str) -> str: ...
def http_get(url: str) -> HTTPResponse: ...
def fs_read(path: str) -> str: ...
def fs_write(path: str, content: str) -> str: ...
def fs_list(path: str) -> list[FSEntry]: ...
def fs_exists(path: str) -> bool: ...
def fs_mkdir(path: str) -> str: ...
def fs_remove(path: str) -> str: ...
def fs_stat(path: str) -> FSStatResult: ...

# Async host functions - use with asyncio.gather() for concurrent execution
async def async_kv_get(key: str) -> str | None: ...
async def async_kv_set(key: str, value: str) -> str: ...
async def async_kv_delete(key: str) -> str: ...
async def async_http_get(url: str) -> HTTPResponse: ...
async def async_fs_read(path: str) -> str: ...
async def async_fs_write(path: str, content: str) -> str: ...
async def async_fs_list(path: str) -> list[FSEntry]: ...
async def async_fs_exists(path: str) -> bool: ...
async def async_fs_mkdir(path: str) -> str: ...
async def async_fs_remove(path: str) -> str: ...
async def async_fs_stat(path: str) -> FSStatResult: ...

# Async utilities
def run_async[T](coro: Coroutine[Any, Any, T]) -> T: ...
def async_call(fn: str, args: dict[str, Any]) -> Coroutine[Any, Any, Any]: ...

# Low-level protocol
def _goru_call(fn: str, args: dict[str, Any]) -> Any: ...
